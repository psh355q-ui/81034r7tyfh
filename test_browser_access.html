<!DOCTYPE html>
<html>
<head>
    <title>AI Trading System - Connection Test</title>
    <meta charset="UTF-8">
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #007bff;
            padding-bottom: 10px;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .link-box {
            background: #e9ecef;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .link-box a {
            color: #007bff;
            text-decoration: none;
            display: block;
            margin: 5px 0;
        }
        .link-box a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ AI Trading System - Connection Test</h1>

        <div class="info result">
            <strong>ì„œë²„ ìƒíƒœ:</strong> ì‹¤í–‰ ì¤‘<br>
            <strong>ì£¼ì†Œ:</strong> http://0.0.0.0:8000<br>
            <strong>ì‹œê°„:</strong> <span id="time"></span>
        </div>

        <h2>ğŸ“¡ ë¹ ë¥¸ ë§í¬</h2>
        <div class="link-box">
            <a href="http://localhost:8000/docs" target="_blank">
                ğŸ“š Swagger UI (API ë¬¸ì„œ) - http://localhost:8000/docs
            </a>
            <a href="http://localhost:8000/redoc" target="_blank">
                ğŸ“– ReDoc (API ë¬¸ì„œ) - http://localhost:8000/redoc
            </a>
            <a href="http://localhost:8000/kis/health" target="_blank">
                âœ… Health Check - http://localhost:8000/kis/health
            </a>
            <a href="http://192.168.50.148:8000/docs" target="_blank">
                ğŸŒ Swagger UI (ë„¤íŠ¸ì›Œí¬) - http://192.168.50.148:8000/docs
            </a>
        </div>

        <h2>ğŸ§ª ì—°ê²° í…ŒìŠ¤íŠ¸</h2>
        <button class="test-button" onclick="testLocalhost()">Test localhost:8000</button>
        <button class="test-button" onclick="testIP()">Test 192.168.50.148:8000</button>
        <button class="test-button" onclick="testHealth()">Test /kis/health</button>

        <div id="result"></div>

        <h2>ğŸ“ ë¬¸ì œ í•´ê²°</h2>
        <div class="info result">
            <strong>ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸:</strong><br>
            - PowerShell/CMDì—ì„œ "start_server_localhost.bat" ì‹¤í–‰ ì¤‘ì´ì–´ì•¼ í•¨<br>
            - ë¡œê·¸ì— "Uvicorn running on http://0.0.0.0:8000" í‘œì‹œë˜ì–´ì•¼ í•¨<br><br>

            <strong>ë¸Œë¼ìš°ì € ìºì‹œ ë¬¸ì œ:</strong><br>
            - Ctrl + Shift + R (ê°•ë ¥ ìƒˆë¡œê³ ì¹¨)<br>
            - ì‹œí¬ë¦¿/í”„ë¼ì´ë¹— ëª¨ë“œì—ì„œ ì‹œë„<br><br>

            <strong>ë°©í™”ë²½ ë¬¸ì œ:</strong><br>
            - Windows Defender ë°©í™”ë²½ ì„¤ì • í™•ì¸<br>
            - í¬íŠ¸ 8000ì´ ì°¨ë‹¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸<br><br>

            <strong>ë‹¤ë¥¸ í”„ë¡œê·¸ë¨ ì¶©ëŒ:</strong><br>
            - í¬íŠ¸ 8000ì„ ì‚¬ìš©í•˜ëŠ” ë‹¤ë¥¸ í”„ë¡œê·¸ë¨ ì¢…ë£Œ<br>
            - netstat -ano | findstr :8000 ìœ¼ë¡œ í™•ì¸
        </div>
    </div>

    <script>
        // Update time
        document.getElementById('time').textContent = new Date().toLocaleString('ko-KR');

        function showResult(message, type) {
            const resultDiv = document.getElementById('result');
            resultDiv.className = 'result ' + type;
            resultDiv.innerHTML = message;
        }

        async function testLocalhost() {
            showResult('Testing localhost:8000...', 'info');
            try {
                const response = await fetch('http://localhost:8000/kis/health');
                const data = await response.json();
                showResult(
                    `âœ… <strong>SUCCESS!</strong><br><br>` +
                    `Status: ${data.status}<br>` +
                    `KIS Available: ${data.kis_available}<br>` +
                    `Message: ${data.message}<br>` +
                    `Time: ${data.timestamp}`,
                    'success'
                );
            } catch (error) {
                showResult(
                    `âŒ <strong>FAILED!</strong><br><br>` +
                    `Error: ${error.message}<br><br>` +
                    `ê°€ëŠ¥í•œ ì›ì¸:<br>` +
                    `1. ì„œë²„ê°€ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ<br>` +
                    `2. ë°©í™”ë²½/ë³´ì•ˆ í”„ë¡œê·¸ë¨ ì°¨ë‹¨<br>` +
                    `3. ë¸Œë¼ìš°ì € ë³´ì•ˆ ì„¤ì •`,
                    'error'
                );
            }
        }

        async function testIP() {
            showResult('Testing 192.168.50.148:8000...', 'info');
            try {
                const response = await fetch('http://192.168.50.148:8000/kis/health');
                const data = await response.json();
                showResult(
                    `âœ… <strong>SUCCESS!</strong><br><br>` +
                    `Status: ${data.status}<br>` +
                    `KIS Available: ${data.kis_available}<br>` +
                    `Message: ${data.message}`,
                    'success'
                );
            } catch (error) {
                showResult(
                    `âŒ <strong>FAILED!</strong><br><br>` +
                    `Error: ${error.message}<br><br>` +
                    `ë„¤íŠ¸ì›Œí¬ IPë¡œ ì ‘ì† ì‹¤íŒ¨`,
                    'error'
                );
            }
        }

        async function testHealth() {
            showResult('Testing /kis/health endpoint...', 'info');
            try {
                const response = await fetch('http://localhost:8000/kis/health');
                const data = await response.json();
                showResult(
                    `âœ… <strong>Health Check OK!</strong><br><br>` +
                    `<pre>${JSON.stringify(data, null, 2)}</pre>`,
                    'success'
                );
            } catch (error) {
                showResult(
                    `âŒ <strong>Health Check Failed!</strong><br><br>` +
                    `${error.message}`,
                    'error'
                );
            }
        }

        // Auto-test on load
        window.onload = function() {
            setTimeout(testLocalhost, 1000);
        };
    </script>
</body>
</html>
