**END OF DOCUMENT**

---
---

# ì¼ì¼ PDF ë³´ê³ ì„œ ìë™ ìƒì„± ì‹œìŠ¤í…œ êµ¬í˜„ ê³„íš

**ì‘ì„±ì¼**: 2026-01-03
**ìš°ì„ ìˆœìœ„**: P1 (High - Immediate Value)
**ìƒíƒœ**: ğŸ“‹ Plan Ready - User Approved

---

## 1. ëª©í‘œ ë° ë²”ìœ„

### ëª©í‘œ
- **ì¼ì¼ PDF ë³´ê³ ì„œ** ìë™ ìƒì„± ì‹œìŠ¤í…œ êµ¬ì¶•
- Shadow Trading ì„±ê³¼, War Room í† ë¡ , Deep Reasoning, ë°°ë‹¹ì£¼ ì •ë³´ë¥¼ í¬í•¨í•œ ì¢…í•© ë³´ê³ ì„œ
- Telegram ì „ì†¡ + ë¡œì»¬ ì €ì¥
- ìˆ˜ë™ ì‹¤í–‰ (API ì—”ë“œí¬ì¸íŠ¸)

### ë²”ìœ„
- âœ… ì¼ì¼ ë¦¬í¬íŠ¸ë§Œ êµ¬í˜„ (ì£¼ê°„/ì›”ê°„ì€ ì¶”í›„)
- âœ… 5ê°€ì§€ í•µì‹¬ ì„¹ì…˜: Shadow Trading, War Room MVP, Deep Reasoning, ë°°ë‹¹ì£¼, ì„±ê³¼ ì°¨íŠ¸
- âœ… Telegram + ë¡œì»¬ ì €ì¥
- â¸ï¸ ìë™ ìŠ¤ì¼€ì¤„ë§ì€ ì¶”í›„ (APScheduler)

---

## 2. ì•„í‚¤í…ì²˜ ì„¤ê³„

### 2.1 ì „ì²´ íŒŒì´í”„ë¼ì¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Daily Report Generation Pipeline               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤

1. API ìš”ì²­
   POST /api/reports/daily
   Body: { "report_date": "2026-01-03" (optional) }

2. Data Collection (5ê°œ Collector)
   â”œâ”€ ShadowTradingCollector â†’ Offensive + Defensive ì„±ê³¼
   â”œâ”€ WarRoomCollector â†’ Agent í† ë¡  ì´ë ¥
   â”œâ”€ DeepReasoningCollector â†’ ìµœì‹  ì¸ì‚¬ì´íŠ¸
   â”œâ”€ DividendCollector â†’ ë°°ë‹¹ì£¼ ì •ë³´ (NEW)
   â””â”€ PerformanceCollector â†’ ì¼ì¼ ì„±ê³¼ ë©”íŠ¸ë¦­

3. Report Assembly
   â”œâ”€ DailyReportAssembler
   â””â”€ 5ê°œ ì„¹ì…˜ìœ¼ë¡œ êµ¬ì„±ëœ ReportData ìƒì„±

4. PDF Rendering (ReportLab)
   â”œâ”€ DailyPDFRenderer
   â”œâ”€ Matplotlib ì°¨íŠ¸ ì„ë² ë”©
   â””â”€ A4 í˜ì´ì§€ ë ˆì´ì•„ì›ƒ

5. Distribution
   â”œâ”€ Telegram (PDF + ìš”ì•½ ë©”ì‹œì§€)
   â””â”€ Local Save (/reports/YYYY-MM-DD_daily.pdf)

6. Response
   return { "pdf_path": "...", "telegram_sent": true }
```

### 2.2 í´ë˜ìŠ¤ êµ¬ì¡°

```python
# backend/reporting/daily_report_generator.py

class DailyReportGenerator:
    """ì¼ì¼ ë³´ê³ ì„œ ìƒì„± ë©”ì¸ í´ë˜ìŠ¤"""

    def __init__(self):
        self.collectors = {
            'shadow_trading': ShadowTradingCollector(),
            'war_room': WarRoomCollector(),
            'deep_reasoning': DeepReasoningCollector(),
            'dividend': DividendCollector(),
            'performance': PerformanceCollector()
        }
        self.assembler = DailyReportAssembler()
        self.renderer = DailyPDFRenderer()
        self.distributor = ReportDistributor()

    def generate(self, report_date: date) -> ReportResult:
        """
        1. ë°ì´í„° ìˆ˜ì§‘
        2. ë¦¬í¬íŠ¸ ì¡°ë¦½
        3. PDF ë Œë”ë§
        4. ë°°í¬
        """
        pass
```

---

## 3. ë°ì´í„° ìˆ˜ì§‘ (Collectors)

### 3.1 ShadowTradingCollector

**íŒŒì¼**: `backend/reporting/collectors/shadow_trading_collector.py` (ì‹ ê·œ)

**ì—­í• **: Shadow Trading ì„±ê³¼ ë°ì´í„° ìˆ˜ì§‘

**êµ¬í˜„**:
```python
from backend.ai.war_room.shadow_trading_tracker import UnifiedShadowTracker
from backend.database.repository import ShadowTradeRepository

class ShadowTradingCollector:
    def collect(self, report_date: date) -> ShadowTradingData:
        """
        1. UnifiedShadowTrackerì—ì„œ Offensive ì„±ê³¼ ì¡°íšŒ
        2. generate_shield_report()ë¡œ Defensive ì„±ê³¼ ì¡°íšŒ
        3. ì¼ì¼ ê±°ë˜ ë‚´ì—­ (í•´ë‹¹ ë‚ ì§œ CLOSED ê±°ë˜)
        """
        tracker = UnifiedShadowTracker()

        # Offensive (ê³µê²©ì  íŠ¸ë ˆì´ë”©)
        offensive = tracker.get_offensive_performance(
            start_date=report_date,
            end_date=report_date
        )

        # Defensive (ë°©ì–´ì  ì¶”ì )
        shield_report = tracker.generate_shield_report(period_days=1)

        # ì¼ì¼ ê±°ë˜ ë‚´ì—­
        repo = ShadowTradeRepository()
        daily_trades = repo.get_trades_by_date(report_date)

        return ShadowTradingData(
            offensive=offensive,
            defensive=shield_report,
            daily_trades=daily_trades
        )
```

**ë°ì´í„° êµ¬ì¡°**:
```python
@dataclass
class ShadowTradingData:
    offensive: dict  # Win Rate, Sharpe, P&L
    defensive: dict  # Avoided Losses, Defensive Wins
    daily_trades: List[ShadowTrade]  # ì˜¤ëŠ˜ ê±°ë˜ ë‚´ì—­
```

---

### 3.2 WarRoomCollector

**íŒŒì¼**: `backend/reporting/collectors/war_room_collector.py` (ì‹ ê·œ)

**ì—­í• **: War Room MVP í† ë¡  ì´ë ¥ ìˆ˜ì§‘

**êµ¬í˜„**:
```python
class WarRoomCollector:
    def collect(self, report_date: date) -> WarRoomData:
        """
        1. War Room ê²°ì • ì´ë ¥ ì¡°íšŒ (í•´ë‹¹ ë‚ ì§œ)
        2. Agentë³„ ì˜ê²¬ ì§‘ê³„
        3. PM ìµœì¢… ê²°ì • í†µê³„
        """
        # ì˜µì…˜ 1: API í˜¸ì¶œ
        response = requests.get(
            f"http://localhost:8001/api/war-room-mvp/history",
            params={'date': report_date.isoformat()}
        )
        decisions = response.json()

        # ì˜µì…˜ 2: ì§ì ‘ DB ì¡°íšŒ (ë” íš¨ìœ¨ì )
        # repo = WarRoomDecisionRepository()
        # decisions = repo.get_decisions_by_date(report_date)

        return WarRoomData(
            total_deliberations=len(decisions),
            approved=len([d for d in decisions if d['final_decision'] == 'approve']),
            rejected=len([d for d in decisions if d['final_decision'] == 'reject']),
            highlights=decisions[:3]  # Top 3
        )
```

**ë°ì´í„° êµ¬ì¡°**:
```python
@dataclass
class WarRoomData:
    total_deliberations: int
    approved: int
    rejected: int
    reduced_size: int
    highlights: List[dict]  # Top 3 deliberations
```

---

### 3.3 DeepReasoningCollector

**íŒŒì¼**: `backend/reporting/collectors/deep_reasoning_collector.py` (ì‹ ê·œ)

**ì—­í• **: Deep Reasoning ìµœì‹  ì¸ì‚¬ì´íŠ¸ ìˆ˜ì§‘

**êµ¬í˜„**:
```python
from backend.ai.skills.deep_reasoning.deep_reasoning_store import DeepReasoningStore

class DeepReasoningCollector:
    def collect(self, report_date: date) -> DeepReasoningData:
        """
        1. DeepReasoningStoreì—ì„œ ìµœì‹  ë¶„ì„ ì¡°íšŒ
        2. Theme, Beneficiaries ì¶”ì¶œ
        3. Top 3 ì¸ì‚¬ì´íŠ¸ ì„ ì •
        """
        store = DeepReasoningStore()

        # í•´ë‹¹ ë‚ ì§œ ë¶„ì„ ì¡°íšŒ
        analyses = store.get_analyses_by_date(report_date, limit=10)

        if not analyses:
            return DeepReasoningData(insights=[])

        # Top 3 ì„ ì • (ì¤‘ìš”ë„ ê¸°ì¤€)
        top_insights = sorted(
            analyses,
            key=lambda x: x.get('importance_score', 0),
            reverse=True
        )[:3]

        return DeepReasoningData(
            total_analyses=len(analyses),
            insights=[
                {
                    'theme': a['theme'],
                    'beneficiaries': a['beneficiaries'],
                    'summary': a['reasoning_trace'][:200]  # ìš”ì•½
                }
                for a in top_insights
            ]
        )
```

**ë°ì´í„° êµ¬ì¡°**:
```python
@dataclass
class DeepReasoningData:
    total_analyses: int
    insights: List[dict]  # [{"theme": "...", "beneficiaries": [...], "summary": "..."}]
```

---

### 3.4 DividendCollector (NEW)

**íŒŒì¼**: `backend/reporting/collectors/dividend_collector.py` (ì‹ ê·œ)

**ì—­í• **: ë°°ë‹¹ì£¼ ì •ë³´ ìˆ˜ì§‘

**êµ¬í˜„**:
```python
import yfinance as yf
from datetime import datetime, timedelta

class DividendCollector:
    def collect(self, report_date: date) -> DividendData:
        """
        1. í˜„ì¬ í¬íŠ¸í´ë¦¬ì˜¤ì—ì„œ ë³´ìœ  ì¢…ëª© ì¡°íšŒ
        2. yfinance APIë¡œ ë°°ë‹¹ ì •ë³´ ì¡°íšŒ
        3. ë°°ë‹¹ ì£¼ê¸° íŒë‹¨ (ì›”/ë¶„ê¸°/ë°˜ê¸°/ì—°)
        4. ì˜ˆì • ë°°ë‹¹ê¸ˆ ë° ë°°ë‹¹ì¼ ê³„ì‚°
        """
        # í¬íŠ¸í´ë¦¬ì˜¤ ì¡°íšŒ
        portfolio = self._get_current_portfolio()

        dividend_stocks = []
        for position in portfolio:
            ticker = position['ticker']
            shares = position['shares']

            # yfinanceë¡œ ë°°ë‹¹ ì •ë³´ ì¡°íšŒ
            stock = yf.Ticker(ticker)
            dividends = stock.dividends

            if dividends.empty:
                continue  # ë°°ë‹¹ ì—†ìŒ

            # ë°°ë‹¹ ì£¼ê¸° íŒë‹¨
            dividend_frequency = self._determine_frequency(dividends)

            # ìµœê·¼ ë°°ë‹¹ ì •ë³´
            latest_dividend = dividends.iloc[-1]
            dividend_per_share = latest_dividend

            # ì´ ë°°ë‹¹ ì˜ˆì •ê¸ˆì•¡
            total_dividend = dividend_per_share * shares

            # ë‹¤ìŒ ë°°ë‹¹ ì˜ˆì •ì¼ (ì¶”ì •)
            next_dividend_date = self._estimate_next_dividend_date(
                dividends, dividend_frequency
            )

            dividend_stocks.append({
                'ticker': ticker,
                'shares': shares,
                'frequency': dividend_frequency,  # "Monthly", "Quarterly", etc.
                'dividend_per_share': float(dividend_per_share),
                'total_dividend': float(total_dividend),
                'next_dividend_date': next_dividend_date.isoformat()
            })

        return DividendData(dividend_stocks=dividend_stocks)

    def _get_current_portfolio(self) -> List[dict]:
        """Shadow Trading í¬íŠ¸í´ë¦¬ì˜¤ ì¡°íšŒ"""
        # ShadowTradingEngineì—ì„œ í˜„ì¬ í¬ì§€ì…˜ ì¡°íšŒ
        from backend.execution.shadow_trading_mvp import ShadowTradingEngine
        engine = ShadowTradingEngine()
        portfolio = engine.get_portfolio_state()

        return [
            {'ticker': pos['ticker'], 'shares': pos['shares']}
            for pos in portfolio.get('positions', [])
            if pos['status'] == 'OPEN'
        ]

    def _determine_frequency(self, dividends: pd.Series) -> str:
        """ë°°ë‹¹ ì£¼ê¸° íŒë‹¨"""
        # ìµœê·¼ 1ë…„ ë°°ë‹¹ íšŸìˆ˜ ê³„ì‚°
        one_year_ago = datetime.now() - timedelta(days=365)
        recent_dividends = dividends[dividends.index > one_year_ago]

        count = len(recent_dividends)

        if count >= 12:
            return "Monthly"
        elif count >= 4:
            return "Quarterly"
        elif count >= 2:
            return "Semi-Annual"
        else:
            return "Annual"

    def _estimate_next_dividend_date(
        self, dividends: pd.Series, frequency: str
    ) -> datetime:
        """ë‹¤ìŒ ë°°ë‹¹ ì˜ˆì •ì¼ ì¶”ì •"""
        last_dividend_date = dividends.index[-1]

        if frequency == "Monthly":
            delta = timedelta(days=30)
        elif frequency == "Quarterly":
            delta = timedelta(days=90)
        elif frequency == "Semi-Annual":
            delta = timedelta(days=180)
        else:  # Annual
            delta = timedelta(days=365)

        return last_dividend_date + delta
```

**ë°ì´í„° êµ¬ì¡°**:
```python
@dataclass
class DividendData:
    dividend_stocks: List[dict]
    # [
    #   {
    #     "ticker": "AAPL",
    #     "shares": 100,
    #     "frequency": "Quarterly",
    #     "dividend_per_share": 0.24,
    #     "total_dividend": 24.00,
    #     "next_dividend_date": "2026-02-15"
    #   }
    # ]
```

---

### 3.5 PerformanceCollector

**íŒŒì¼**: `backend/reporting/collectors/performance_collector.py` (ì‹ ê·œ)

**ì—­í• **: ì¼ì¼ ì„±ê³¼ ë©”íŠ¸ë¦­ ìˆ˜ì§‘

**êµ¬í˜„**:
```python
from backend.core.models.analytics_models import DailyAnalytics

class PerformanceCollector:
    def collect(self, report_date: date) -> PerformanceData:
        """
        1. DailyAnalytics í…Œì´ë¸”ì—ì„œ í•´ë‹¹ ë‚ ì§œ ì¡°íšŒ
        2. ì„±ê³¼ ë©”íŠ¸ë¦­ ì¶”ì¶œ
        """
        session = get_db_session()

        daily_analytics = session.query(DailyAnalytics).filter(
            DailyAnalytics.date == report_date
        ).first()

        if not daily_analytics:
            # ë°ì´í„° ì—†ìœ¼ë©´ ê¸°ë³¸ê°’
            return PerformanceData(
                portfolio_value=100000.00,
                daily_pnl=0.00,
                win_rate=0.0,
                sharpe_ratio=0.0
            )

        return PerformanceData(
            portfolio_value=daily_analytics.portfolio_value_eod,
            daily_pnl=daily_analytics.daily_pnl,
            win_rate=daily_analytics.win_rate,
            sharpe_ratio=daily_analytics.sharpe_ratio,
            max_drawdown=daily_analytics.max_drawdown_pct,
            volatility=daily_analytics.volatility_30d
        )
```

**ë°ì´í„° êµ¬ì¡°**:
```python
@dataclass
class PerformanceData:
    portfolio_value: Decimal
    daily_pnl: Decimal
    win_rate: Decimal
    sharpe_ratio: Decimal
    max_drawdown: Optional[Decimal] = None
    volatility: Optional[Decimal] = None
```

---

## 4. Report Assembly

### 4.1 DailyReportAssembler

**íŒŒì¼**: `backend/reporting/assemblers/daily_report_assembler.py` (ì‹ ê·œ)

**ì—­í• **: ìˆ˜ì§‘ëœ ë°ì´í„°ë¥¼ ë¦¬í¬íŠ¸ êµ¬ì¡°ë¡œ ì¡°ë¦½

**êµ¬í˜„**:
```python
@dataclass
class DailyReportData:
    """ì¼ì¼ ë¦¬í¬íŠ¸ ìµœì¢… ë°ì´í„° êµ¬ì¡°"""
    metadata: dict
    executive_summary: dict
    shadow_trading: ShadowTradingData
    war_room: WarRoomData
    deep_reasoning: DeepReasoningData
    dividends: DividendData
    performance: PerformanceData

class DailyReportAssembler:
    def assemble(
        self,
        report_date: date,
        collected_data: dict
    ) -> DailyReportData:
        """
        1. Metadata ìƒì„±
        2. Executive Summary ìƒì„± (KPI ì¶”ì¶œ)
        3. ê° ì„¹ì…˜ ë°ì´í„° ì •ë¦¬
        """
        # Metadata
        metadata = {
            'report_id': f"DAILY_{report_date.strftime('%Y%m%d')}",
            'report_date': report_date.isoformat(),
            'generated_at': datetime.utcnow().isoformat(),
            'title': f"Daily Trading Report - {report_date.strftime('%Y-%m-%d')}"
        }

        # Executive Summary (í•µì‹¬ KPI)
        exec_summary = {
            'portfolio_value': collected_data['performance'].portfolio_value,
            'daily_pnl': collected_data['performance'].daily_pnl,
            'win_rate': collected_data['shadow_trading'].offensive.get('win_rate', 0),
            'sharpe_ratio': collected_data['performance'].sharpe_ratio,
            'highlights': self._generate_highlights(collected_data),
            'alerts': self._generate_alerts(collected_data)
        }

        return DailyReportData(
            metadata=metadata,
            executive_summary=exec_summary,
            shadow_trading=collected_data['shadow_trading'],
            war_room=collected_data['war_room'],
            deep_reasoning=collected_data['deep_reasoning'],
            dividends=collected_data['dividends'],
            performance=collected_data['performance']
        )

    def _generate_highlights(self, data: dict) -> List[str]:
        """í•˜ì´ë¼ì´íŠ¸ ìë™ ìƒì„±"""
        highlights = []

        # Shadow Trading ì„±ê³¼
        offensive = data['shadow_trading'].offensive
        if offensive.get('win_rate', 0) > 0.6:
            highlights.append(f"ğŸ¯ High Win Rate: {offensive['win_rate']:.1%}")

        # War Room ìŠ¹ì¸ìœ¨
        war_room = data['war_room']
        if war_room.total_deliberations > 0:
            approve_rate = war_room.approved / war_room.total_deliberations
            if approve_rate > 0.7:
                highlights.append(f"âœ… War Room Approval: {approve_rate:.1%}")

        # ë°°ë‹¹ ìˆ˜ë ¹
        dividends = data['dividends'].dividend_stocks
        if dividends:
            total_dividend = sum(d['total_dividend'] for d in dividends)
            highlights.append(f"ğŸ’° Dividend Income: ${total_dividend:.2f}")

        return highlights

    def _generate_alerts(self, data: dict) -> List[str]:
        """ìœ„í—˜ ì•Œë¦¼ ìë™ ìƒì„±"""
        alerts = []

        # Max Drawdown ì²´í¬
        perf = data['performance']
        if perf.max_drawdown and perf.max_drawdown < -0.10:
            alerts.append(f"âš ï¸ Max Drawdown: {perf.max_drawdown:.2%}")

        # ì¼ì¼ ì†ì‹¤ ì²´í¬
        if perf.daily_pnl < -5000:
            alerts.append(f"ğŸš¨ Daily Loss: ${perf.daily_pnl:.2f}")

        return alerts
```

---

## 5. PDF Rendering

### 5.1 DailyPDFRenderer

**íŒŒì¼**: `backend/reporting/renderers/daily_pdf_renderer.py` (ì‹ ê·œ)

**ì—­í• **: ReportLabìœ¼ë¡œ PDF ìƒì„±

**êµ¬í˜„**:
```python
from reportlab.lib.pagesizes import A4
from reportlab.lib.styles import getSampleStyleSheet, ParagraphStyle
from reportlab.lib.units import inch
from reportlab.platypus import (
    SimpleDocTemplate, Paragraph, Spacer, Table, TableStyle, Image
)
from reportlab.lib import colors

class DailyPDFRenderer:
    def __init__(self):
        self.pagesize = A4
        self.styles = getSampleStyleSheet()
        self._define_custom_styles()

    def _define_custom_styles(self):
        """ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼ ì •ì˜"""
        self.title_style = ParagraphStyle(
            'CustomTitle',
            parent=self.styles['Heading1'],
            fontSize=24,
            textColor=colors.HexColor('#667eea'),
            spaceAfter=30,
            alignment=1  # Center
        )

        self.section_style = ParagraphStyle(
            'SectionHeader',
            parent=self.styles['Heading2'],
            fontSize=16,
            textColor=colors.HexColor('#4a5568'),
            spaceAfter=12,
            spaceBefore=20
        )

    def render(self, report_data: DailyReportData, output_path: str):
        """
        PDF ìƒì„±

        ì„¹ì…˜ êµ¬ì„±:
        1. Title & Metadata
        2. Executive Summary (KPI í…Œì´ë¸”)
        3. Shadow Trading Performance (Offensive + Defensive)
        4. War Room MVP Deliberations
        5. Deep Reasoning Insights
        6. Dividend Information (ë°°ë‹¹ì£¼)
        7. Performance Charts (Matplotlib)
        """
        doc = SimpleDocTemplate(
            output_path,
            pagesize=self.pagesize,
            rightMargin=72,
            leftMargin=72,
            topMargin=72,
            bottomMargin=72
        )

        story = []

        # 1. Title
        story.append(Paragraph(report_data.metadata['title'], self.title_style))
        story.append(Paragraph(
            f"Generated: {report_data.metadata['generated_at']}",
            self.styles['Normal']
        ))
        story.append(Spacer(1, 0.5*inch))

        # 2. Executive Summary
        story.extend(self._render_executive_summary(report_data.executive_summary))

        # 3. Shadow Trading
        story.extend(self._render_shadow_trading(report_data.shadow_trading))

        # 4. War Room
        story.extend(self._render_war_room(report_data.war_room))

        # 5. Deep Reasoning
        story.extend(self._render_deep_reasoning(report_data.deep_reasoning))

        # 6. Dividends (NEW)
        story.extend(self._render_dividends(report_data.dividends))

        # 7. Charts
        story.extend(self._render_charts(report_data))

        # Build PDF
        doc.build(story)

    def _render_executive_summary(self, summary: dict) -> List:
        """Executive Summary ì„¹ì…˜"""
        elements = []

        elements.append(Paragraph("ğŸ“Š Executive Summary", self.section_style))

        # KPI Table
        data = [
            ['Metric', 'Value'],
            ['Portfolio Value', f"${summary['portfolio_value']:,.2f}"],
            ['Daily P&L', f"${summary['daily_pnl']:,.2f}"],
            ['Win Rate', f"{summary['win_rate']:.2%}"],
            ['Sharpe Ratio', f"{summary['sharpe_ratio']:.2f}"]
        ]

        table = Table(data, colWidths=[3*inch, 3*inch])
        table.setStyle(TableStyle([
            ('BACKGROUND', (0, 0), (-1, 0), colors.HexColor('#667eea')),
            ('TEXTCOLOR', (0, 0), (-1, 0), colors.whitesmoke),
            ('ALIGN', (0, 0), (-1, -1), 'LEFT'),
            ('FONTNAME', (0, 0), (-1, 0), 'Helvetica-Bold'),
            ('FONTSIZE', (0, 0), (-1, 0), 12),
            ('BOTTOMPADDING', (0, 0), (-1, 0), 12),
            ('GRID', (0, 0), (-1, -1), 1, colors.black)
        ]))

        elements.append(table)
        elements.append(Spacer(1, 0.3*inch))

        # Highlights
        if summary['highlights']:
            elements.append(Paragraph("<b>Highlights:</b>", self.styles['Normal']))
            for highlight in summary['highlights']:
                elements.append(Paragraph(f"â€¢ {highlight}", self.styles['Normal']))

        # Alerts
        if summary['alerts']:
            elements.append(Spacer(1, 0.2*inch))
            elements.append(Paragraph("<b>Alerts:</b>", self.styles['Normal']))
            for alert in summary['alerts']:
                elements.append(Paragraph(f"â€¢ {alert}", self.styles['Normal']))

        return elements

    def _render_dividends(self, dividends: DividendData) -> List:
        """ë°°ë‹¹ì£¼ ì •ë³´ ì„¹ì…˜ (NEW)"""
        elements = []

        elements.append(Paragraph("ğŸ’° Dividend Information", self.section_style))

        if not dividends.dividend_stocks:
            elements.append(Paragraph("No dividend stocks in portfolio.", self.styles['Normal']))
            return elements

        # ë°°ë‹¹ì£¼ í…Œì´ë¸”
        data = [
            ['Ticker', 'Shares', 'Frequency', 'Per Share', 'Total', 'Next Date']
        ]

        for stock in dividends.dividend_stocks:
            data.append([
                stock['ticker'],
                str(stock['shares']),
                stock['frequency'],
                f"${stock['dividend_per_share']:.2f}",
                f"${stock['total_dividend']:.2f}",
                stock['next_dividend_date']
            ])

        table = Table(data, colWidths=[0.8*inch, 0.8*inch, 1.2*inch, 1*inch, 1*inch, 1.2*inch])
        table.setStyle(TableStyle([
            ('BACKGROUND', (0, 0), (-1, 0), colors.HexColor('#38a169')),
            ('TEXTCOLOR', (0, 0), (-1, 0), colors.whitesmoke),
            ('ALIGN', (0, 0), (-1, -1), 'CENTER'),
            ('FONTNAME', (0, 0), (-1, 0), 'Helvetica-Bold'),
            ('FONTSIZE', (0, 0), (-1, 0), 10),
            ('BOTTOMPADDING', (0, 0), (-1, 0), 12),
            ('GRID', (0, 0), (-1, -1), 1, colors.black)
        ]))

        elements.append(table)
        elements.append(Spacer(1, 0.3*inch))

        # ì´ ë°°ë‹¹ ì˜ˆì •ê¸ˆì•¡
        total_dividend = sum(s['total_dividend'] for s in dividends.dividend_stocks)
        elements.append(Paragraph(
            f"<b>Total Expected Dividend: ${total_dividend:.2f}</b>",
            self.styles['Normal']
        ))

        return elements

    def _render_charts(self, report_data: DailyReportData) -> List:
        """Matplotlib ì°¨íŠ¸ ì„¹ì…˜"""
        elements = []

        elements.append(Paragraph("ğŸ“ˆ Performance Charts", self.section_style))

        # Chart 1: P&L Trend (ìµœê·¼ 7ì¼)
        chart_path = self._generate_pnl_chart(report_data)
        if chart_path:
            elements.append(Image(chart_path, width=6*inch, height=4*inch))

        return elements

    def _generate_pnl_chart(self, report_data: DailyReportData) -> Optional[str]:
        """P&L ì¶”ì´ ì°¨íŠ¸ ìƒì„± (Matplotlib)"""
        import matplotlib.pyplot as plt
        import matplotlib.dates as mdates
        from datetime import datetime, timedelta

        # ìµœê·¼ 7ì¼ ë°ì´í„° ì¡°íšŒ
        end_date = datetime.strptime(report_data.metadata['report_date'], '%Y-%m-%d').date()
        start_date = end_date - timedelta(days=7)

        # DailyAnalyticsì—ì„œ ë°ì´í„° ì¡°íšŒ
        session = get_db_session()
        analytics = session.query(DailyAnalytics).filter(
            DailyAnalytics.date >= start_date,
            DailyAnalytics.date <= end_date
        ).order_by(DailyAnalytics.date).all()

        if not analytics:
            return None

        # ë°ì´í„° ì¶”ì¶œ
        dates = [a.date for a in analytics]
        pnls = [float(a.daily_pnl) for a in analytics]

        # ì°¨íŠ¸ ìƒì„±
        fig, ax = plt.subplots(figsize=(10, 6))
        ax.plot(dates, pnls, marker='o', linestyle='-', linewidth=2, color='#667eea')
        ax.axhline(y=0, color='red', linestyle='--', linewidth=1)

        ax.set_xlabel('Date')
        ax.set_ylabel('Daily P&L ($)')
        ax.set_title('Daily P&L Trend (Last 7 Days)')
        ax.grid(True, alpha=0.3)

        # ë‚ ì§œ í¬ë§·
        ax.xaxis.set_major_formatter(mdates.DateFormatter('%m-%d'))

        # ì €ì¥
        chart_path = f"/tmp/pnl_chart_{end_date.isoformat()}.png"
        fig.savefig(chart_path, format='png', bbox_inches='tight', dpi=150)
        plt.close()

        return chart_path
```

---

## 6. Distribution (ë°°í¬)

### 6.1 ReportDistributor

**íŒŒì¼**: `backend/reporting/distributors/report_distributor.py` (ì‹ ê·œ)

**ì—­í• **: PDF ë°°í¬ (Telegram + ë¡œì»¬ ì €ì¥)

**êµ¬í˜„**:
```python
from backend.notifications.telegram_notifier import TelegramPDFSender

class ReportDistributor:
    def __init__(self):
        self.telegram_sender = TelegramPDFSender()
        self.local_dir = Path("/reports")
        self.local_dir.mkdir(exist_ok=True)

    def distribute(
        self,
        pdf_path: str,
        report_data: DailyReportData
    ) -> DistributionResult:
        """
        1. Telegram ì „ì†¡ (PDF + ìš”ì•½ ë©”ì‹œì§€)
        2. ë¡œì»¬ ì €ì¥
        """
        results = {}

        # 1. Telegram
        telegram_sent = self._send_via_telegram(pdf_path, report_data)
        results['telegram'] = telegram_sent

        # 2. ë¡œì»¬ ì €ì¥
        local_path = self._save_locally(pdf_path, report_data)
        results['local_path'] = local_path

        return DistributionResult(**results)

    def _send_via_telegram(self, pdf_path: str, report_data: DailyReportData) -> bool:
        """Telegram ì „ì†¡"""
        # ìš”ì•½ ë©”ì‹œì§€ ìƒì„±
        summary = self._generate_telegram_summary(report_data)

        try:
            self.telegram_sender.send_pdf(
                pdf_path=pdf_path,
                caption=summary
            )
            return True
        except Exception as e:
            logger.error(f"Telegram send failed: {e}")
            return False

    def _generate_telegram_summary(self, report_data: DailyReportData) -> str:
        """Telegram ìš”ì•½ ë©”ì‹œì§€"""
        summary = report_data.executive_summary

        message = f"""
ğŸ“Š **Daily Trading Report**
ğŸ“… {report_data.metadata['report_date']}

ğŸ’¼ Portfolio: ${summary['portfolio_value']:,.2f}
ğŸ“ˆ Daily P&L: ${summary['daily_pnl']:,.2f}
ğŸ¯ Win Rate: {summary['win_rate']:.1%}
ğŸ“Š Sharpe: {summary['sharpe_ratio']:.2f}

{chr(10).join(summary['highlights'])}
        """

        return message.strip()

    def _save_locally(self, pdf_path: str, report_data: DailyReportData) -> str:
        """ë¡œì»¬ ì €ì¥"""
        report_date = report_data.metadata['report_date']
        local_filename = f"{report_date}_daily.pdf"
        local_path = self.local_dir / local_filename

        # íŒŒì¼ ë³µì‚¬
        import shutil
        shutil.copy(pdf_path, local_path)

        logger.info(f"Report saved locally: {local_path}")
        return str(local_path)

@dataclass
class DistributionResult:
    telegram: bool
    local_path: str
```

---

## 7. API ì—”ë“œí¬ì¸íŠ¸

### 7.1 Reports Router

**íŒŒì¼**: `backend/routers/reports_router.py` (ì‹ ê·œ)

**êµ¬í˜„**:
```python
from fastapi import APIRouter, HTTPException
from pydantic import BaseModel
from datetime import date, datetime
from backend.reporting.daily_report_generator import DailyReportGenerator

router = APIRouter(prefix="/api/reports", tags=["Reports"])

class GenerateReportRequest(BaseModel):
    report_date: Optional[str] = None  # "2026-01-03" or None (today)

class GenerateReportResponse(BaseModel):
    report_id: str
    pdf_path: str
    telegram_sent: bool
    generated_at: str

@router.post("/daily", response_model=GenerateReportResponse)
async def generate_daily_report(request: GenerateReportRequest):
    """
    ì¼ì¼ ë¦¬í¬íŠ¸ ìƒì„±

    - report_date: ë¦¬í¬íŠ¸ ë‚ ì§œ (ìƒëµ ì‹œ ì˜¤ëŠ˜)
    - ìˆ˜ë™ ì‹¤í–‰ ì „ìš© (ìë™ ìŠ¤ì¼€ì¤„ë§ ì—†ìŒ)
    """
    # ë‚ ì§œ íŒŒì‹±
    if request.report_date:
        report_date = datetime.strptime(request.report_date, '%Y-%m-%d').date()
    else:
        report_date = date.today()

    # ë¦¬í¬íŠ¸ ìƒì„±
    generator = DailyReportGenerator()

    try:
        result = generator.generate(report_date)

        return GenerateReportResponse(
            report_id=result.report_id,
            pdf_path=result.pdf_path,
            telegram_sent=result.telegram_sent,
            generated_at=datetime.utcnow().isoformat()
        )
    except Exception as e:
        logger.error(f"Report generation failed: {e}")
        raise HTTPException(status_code=500, detail=str(e))

@router.get("/daily/{report_date}")
async def get_daily_report(report_date: str):
    """
    ê¸°ì¡´ ë¦¬í¬íŠ¸ ì¡°íšŒ

    - report_date: "2026-01-03" í˜•ì‹
    - ë¡œì»¬ ì €ì¥ëœ PDF íŒŒì¼ ë°˜í™˜
    """
    from fastapi.responses import FileResponse

    local_path = Path(f"/reports/{report_date}_daily.pdf")

    if not local_path.exists():
        raise HTTPException(status_code=404, detail="Report not found")

    return FileResponse(
        local_path,
        media_type='application/pdf',
        filename=f"{report_date}_daily.pdf"
    )
```

**Main.py ë“±ë¡**:
```python
# backend/main.py
from backend.routers.reports_router import router as reports_router

app.include_router(reports_router)
logger.info("Reports router registered")
```

---

## 8. êµ¬í˜„ ìˆœì„œ (Phaseë³„)

### Phase 1: ê¸°ë³¸ PDF ìƒì„± (Shadow Tradingë§Œ) - 4-6ì‹œê°„

**ëª©í‘œ**: ìµœì†Œ ê¸°ëŠ¥ìœ¼ë¡œ PDF ìƒì„± ê²€ì¦

**ì‘ì—…**:
1. `ShadowTradingCollector` êµ¬í˜„
2. `PerformanceCollector` êµ¬í˜„
3. `DailyReportAssembler` (Executive Summary + Shadow Trading ì„¹ì…˜ë§Œ)
4. `DailyPDFRenderer` (ê¸°ë³¸ í…Œì´ë¸”ë§Œ)
5. API ì—”ë“œí¬ì¸íŠ¸ (`POST /api/reports/daily`)

**ê²€ì¦**:
- API í˜¸ì¶œ ì‹œ PDF ìƒì„± í™•ì¸
- Shadow Trading ë°ì´í„° ì •ìƒ í‘œì‹œ í™•ì¸

---

### Phase 2: ì°¨íŠ¸ ì¶”ê°€ (Matplotlib) - 3-4ì‹œê°„

**ëª©í‘œ**: ì„±ê³¼ ì°¨íŠ¸ ì„ë² ë”©

**ì‘ì—…**:
1. Matplotlib ì„¤ì¹˜ (`pip install matplotlib`)
2. `_generate_pnl_chart()` êµ¬í˜„
3. `_render_charts()` ì„¹ì…˜ ì¶”ê°€

**ê²€ì¦**:
- P&L ì¶”ì´ ì°¨íŠ¸ê°€ PDFì— ì •ìƒ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸

---

### Phase 3: ë°°ë‹¹ì£¼ ì •ë³´ ì¶”ê°€ - 4-5ì‹œê°„

**ëª©í‘œ**: ë°°ë‹¹ì£¼ ì„¹ì…˜ ì™„ì„±

**ì‘ì—…**:
1. yfinance ì„¤ì¹˜ (`pip install yfinance`)
2. `DividendCollector` êµ¬í˜„
3. `_render_dividends()` ì„¹ì…˜ ì¶”ê°€
4. ë°°ë‹¹ ì£¼ê¸° íŒë‹¨ ë¡œì§ êµ¬í˜„

**ê²€ì¦**:
- í¬íŠ¸í´ë¦¬ì˜¤ì— ë°°ë‹¹ì£¼ê°€ ìˆìœ¼ë©´ ì •ìƒ í‘œì‹œ
- ë°°ë‹¹ ì£¼ê¸° (Monthly/Quarterly/etc.) ì •í™•íˆ íŒë‹¨

---

### Phase 4: Telegram í†µí•© - 2-3ì‹œê°„

**ëª©í‘œ**: PDF ìë™ ì „ì†¡

**ì‘ì—…**:
1. `ReportDistributor` êµ¬í˜„
2. Telegram ìš”ì•½ ë©”ì‹œì§€ í¬ë§· ê°œì„ 
3. ì—ëŸ¬ ì²˜ë¦¬ (Telegram API ì‹¤íŒ¨ ì‹œ)

**ê²€ì¦**:
- Telegramìœ¼ë¡œ PDF + ìš”ì•½ ë©”ì‹œì§€ ì •ìƒ ì „ì†¡
- ë¡œì»¬ ì €ì¥ í™•ì¸

---

### Phase 5: War Room + Deep Reasoning ì¶”ê°€ - 4-5ì‹œê°„

**ëª©í‘œ**: ì „ì²´ ì„¹ì…˜ ì™„ì„±

**ì‘ì—…**:
1. `WarRoomCollector` êµ¬í˜„
2. `DeepReasoningCollector` êµ¬í˜„
3. `_render_war_room()`, `_render_deep_reasoning()` ì„¹ì…˜ ì¶”ê°€

**ê²€ì¦**:
- 5ê°œ ì„¹ì…˜ ëª¨ë‘ ì •ìƒ í‘œì‹œ
- ë°ì´í„° ì—†ì„ ë•Œë„ ì—ëŸ¬ ì—†ì´ ì²˜ë¦¬

---

## 9. í•µì‹¬ íŒŒì¼ ë¦¬ìŠ¤íŠ¸

### ì‹ ê·œ ìƒì„± (14ê°œ)

**Collectors (5)**:
1. `backend/reporting/collectors/__init__.py`
2. `backend/reporting/collectors/shadow_trading_collector.py`
3. `backend/reporting/collectors/war_room_collector.py`
4. `backend/reporting/collectors/deep_reasoning_collector.py`
5. `backend/reporting/collectors/dividend_collector.py`
6. `backend/reporting/collectors/performance_collector.py`

**Assemblers (1)**:
7. `backend/reporting/assemblers/daily_report_assembler.py`

**Renderers (1)**:
8. `backend/reporting/renderers/daily_pdf_renderer.py`

**Distributors (1)**:
9. `backend/reporting/distributors/report_distributor.py`

**Main Generator (1)**:
10. `backend/reporting/daily_report_generator.py`

**API (1)**:
11. `backend/routers/reports_router.py`

**Tests (3)**:
12. `backend/tests/test_daily_report_generator.py`
13. `backend/tests/test_dividend_collector.py`
14. `backend/tests/test_pdf_rendering.py`

### ìˆ˜ì • íŒŒì¼ (2)

15. `backend/main.py` - Reports router ë“±ë¡
16. `requirements.txt` - yfinance, matplotlib ì¶”ê°€

### ê¸°ì¡´ íŒŒì¼ ì°¸ì¡° (í™œìš©)

17. `backend/ai/war_room/shadow_trading_tracker.py` - UnifiedShadowTracker
18. `backend/core/models/analytics_models.py` - DailyAnalytics
19. `backend/notifications/telegram_notifier.py` - TelegramPDFSender
20. `backend/ai/skills/deep_reasoning/deep_reasoning_store.py` - DeepReasoningStore

---

## 10. í…ŒìŠ¤íŠ¸ ì „ëµ

### 10.1 ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

**íŒŒì¼**: `backend/tests/test_daily_report_generator.py`

```python
import pytest
from datetime import date
from backend.reporting.collectors.shadow_trading_collector import ShadowTradingCollector

def test_shadow_trading_collector():
    """Shadow Trading ë°ì´í„° ìˆ˜ì§‘ í…ŒìŠ¤íŠ¸"""
    collector = ShadowTradingCollector()
    data = collector.collect(date.today())

    assert data is not None
    assert 'offensive' in data.__dict__
    assert 'defensive' in data.__dict__

def test_dividend_collector():
    """ë°°ë‹¹ ì •ë³´ ìˆ˜ì§‘ í…ŒìŠ¤íŠ¸"""
    from backend.reporting.collectors.dividend_collector import DividendCollector

    collector = DividendCollector()
    data = collector.collect(date.today())

    assert isinstance(data.dividend_stocks, list)
```

### 10.2 í†µí•© í…ŒìŠ¤íŠ¸

**íŒŒì¼**: `backend/tests/test_pdf_rendering.py`

```python
def test_full_report_generation():
    """ì „ì²´ ë¦¬í¬íŠ¸ ìƒì„± í†µí•© í…ŒìŠ¤íŠ¸"""
    from backend.reporting.daily_report_generator import DailyReportGenerator

    generator = DailyReportGenerator()
    result = generator.generate(date.today())

    # PDF íŒŒì¼ ìƒì„± í™•ì¸
    assert Path(result.pdf_path).exists()

    # í¬ê¸° í™•ì¸ (> 10KB)
    assert Path(result.pdf_path).stat().st_size > 10000
```

---

## 11. í™•ì¥ì„± ê³ ë ¤ì‚¬í•­

### 11.1 ì£¼ê°„/ì›”ê°„ ë¦¬í¬íŠ¸ ì¶”ê°€ ì‹œ

**êµ¬ì¡° ì¬ì‚¬ìš©**:
- Collector ë™ì¼í•˜ê²Œ ì¬ì‚¬ìš©
- Assemblerë§Œ ê¸°ê°„ë³„ë¡œ ë³€ê²½ (`WeeklyReportAssembler`, `MonthlyReportAssembler`)
- Rendererë„ ì¬ì‚¬ìš© (ì„¹ì…˜ êµ¬ì„±ë§Œ ë‹¤ë¥´ê²Œ)

**ì˜ˆì‹œ**:
```python
# backend/reporting/weekly_report_generator.py

class WeeklyReportGenerator:
    def __init__(self):
        # ë™ì¼í•œ Collector ì¬ì‚¬ìš©
        self.collectors = {
            'shadow_trading': ShadowTradingCollector(),
            'war_room': WarRoomCollector(),
            # ...
        }
        self.assembler = WeeklyReportAssembler()  # ì£¼ê°„ ì „ìš©
        self.renderer = DailyPDFRenderer()        # ì¬ì‚¬ìš©
```

### 11.2 ìë™ ìŠ¤ì¼€ì¤„ë§ ì¶”ê°€ ì‹œ

**APScheduler ì‚¬ìš©**:
```python
# backend/schedulers/report_scheduler.py

from apscheduler.schedulers.asyncio import AsyncIOScheduler
from backend.reporting.daily_report_generator import DailyReportGenerator

scheduler = AsyncIOScheduler()

@scheduler.scheduled_job('cron', hour=9, minute=0)  # ë§¤ì¼ 09:00
def generate_daily_report_job():
    generator = DailyReportGenerator()
    generator.generate(date.today())

scheduler.start()
```

---

## 12. ì„±ê³µ ê¸°ì¤€

- [ ] API í˜¸ì¶œ ì‹œ PDF ì •ìƒ ìƒì„± (< 10ì´ˆ)
- [ ] 5ê°œ ì„¹ì…˜ ëª¨ë‘ ì •ìƒ í‘œì‹œ
- [ ] ë°°ë‹¹ì£¼ ì •ë³´ ì •í™•íˆ ê³„ì‚°
- [ ] Telegram ì „ì†¡ ì„±ê³µë¥  > 95%
- [ ] ë¡œì»¬ ì €ì¥ ì •ìƒ ë™ì‘
- [ ] ì°¨íŠ¸ ì´ë¯¸ì§€ PDFì— ì„ë² ë”©
- [ ] ë°ì´í„° ì—†ì„ ë•Œë„ ì—ëŸ¬ ì—†ì´ ì²˜ë¦¬
- [ ] í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ > 80%

---

## 13. ë‹¤ìŒ ë‹¨ê³„ (Optional)

### ì¦‰ì‹œ êµ¬í˜„ (ì‚¬ìš©ì ìŠ¹ì¸ í›„)

1. âœ… Phase 1: ê¸°ë³¸ PDF ìƒì„± (4-6ì‹œê°„)
2. âœ… Phase 2: ì°¨íŠ¸ ì¶”ê°€ (3-4ì‹œê°„)
3. âœ… Phase 3: ë°°ë‹¹ì£¼ ì •ë³´ ì¶”ê°€ (4-5ì‹œê°„)

**ì˜ˆìƒ ì†Œìš”**: 3-4ì¼ (Phase 1-3 ì™„ë£Œ)

### ì°¨ê¸° ì§„í–‰

4. â¸ï¸ Phase 4: Telegram í†µí•© (2-3ì‹œê°„)
5. â¸ï¸ Phase 5: War Room + Deep Reasoning (4-5ì‹œê°„)
6. â¸ï¸ ì£¼ê°„ ë¦¬í¬íŠ¸ ì¶”ê°€
7. â¸ï¸ APScheduler ìë™ ìŠ¤ì¼€ì¤„ë§

---

**ì‘ì„±ì¼**: 2026-01-03
**ì‘ì„±ì**: AI Trading System Development Team
**ë¬¸ì„œ ë²„ì „**: 1.0
**ìƒíƒœ**: ğŸ“‹ Plan Complete - Ready for Implementation
**ì˜ˆìƒ ì†Œìš” ì‹œê°„**: 17-23ì‹œê°„ (Phase 1-5 ì™„ë£Œ ê¸°ì¤€)

**ë‹¤ìŒ ë‹¨ê³„**: ì‚¬ìš©ì ìŠ¹ì¸ í›„ Phase 1ë¶€í„° ë‹¨ê³„ì  êµ¬í˜„

---

**END OF DAILY REPORT PLAN**