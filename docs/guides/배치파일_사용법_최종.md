# 🚀 배치 파일 사용 가이드 (최종판)

## 📁 배치 파일 목록 (7개)

| 순서 | 파일명 | 용도 | 실행 횟수 |
|------|--------|------|----------|
| 0️⃣ | **0_시스템_체크.bat** | 환경 확인 (Python, Docker, 파일) | 최초 1회 |
| 1️⃣ | **1_DB_마이그레이션.bat** | 데이터베이스 테이블 생성 | 최초 1회 |
| 2️⃣ | **2_데이터수집_테스트.bat** | 5분 테스트 | 선택적 |
| 3️⃣ | **3_데이터수집_시작.bat** | **실제 데이터 수집 (14일)** | **매일 실행** ⭐ |
| 4️⃣ | **4_모니터링_대시보드.bat** | 실시간 모니터링 | 선택적 |
| 5️⃣ | **5_품질리포트_생성.bat** | 품질 리포트 | 주 1-2회 |
| 6️⃣ | **6_로그_확인.bat** | 로그 파일 확인 | 문제 발생 시 |

---

## 🎯 처음 시작하는 경우

### Step 1: 시스템 체크 ✅

```
0_시스템_체크.bat 더블클릭
```

**확인 내용**:
- ✅ Python 설치 여부
- ✅ PostgreSQL/Docker 상태
- ✅ 필수 파일 존재 여부
- ✅ Python 패키지 설치 여부

**예상 출력**:
```
================================================================================
🔍 AI Trading System - 시스템 환경 체크
================================================================================

[1/5] Python 확인
Python 3.11.0
✅ Python 정상

[2/5] PostgreSQL 확인
✅ PostgreSQL 정상

[3/5] Docker 확인
Docker version 24.0.0
✅ Docker PostgreSQL 컨테이너 실행 중

[4/5] 필수 파일 확인
✅ scripts\start_data_accumulation.py
✅ scripts\monitor_accumulation.py
✅ backend\orchestration\data_accumulation_orchestrator.py
✅ backend\database\migrations\add_constitutional_validation_tables.sql

[5/5] Python 패키지 확인
✅ sqlalchemy: 2.0.0
✅ aiohttp: 3.9.0
✅ beautifulsoup4: 4.12.0
✅ feedparser: 6.0.0

✅ 모든 필수 파일이 존재합니다.
```

---

### Step 2: DB 마이그레이션 (최초 1회) 🗄️

```
1_DB_마이그레이션.bat 더블클릭
```

**동작**:
1. 로컬 PostgreSQL 시도
2. 실패 시 Docker PostgreSQL 시도
3. constitutional_validations 테이블 생성
4. constitutional_violations 테이블 생성

**성공 메시지**:
```
================================================================================
✅ 마이그레이션 완료
================================================================================

생성된 테이블:
  ✅ constitutional_validations
  ✅ constitutional_violations

다음 단계:
  1. "2_데이터수집_테스트.bat"로 시스템 테스트 (5분)
  2. "3_데이터수집_시작.bat"로 실제 수집 시작 (14일)
```

---

### Step 3: 테스트 실행 (선택) 🧪

```
2_데이터수집_테스트.bat 더블클릭
```

**테스트 내용**:
- 5분간 데이터 수집
- 최대 5개 토론
- 1분 간격 뉴스 체크

**성공 시**:
```
✅ 테스트 완료! "3_데이터수집_시작.bat"를 실행하세요.
```

---

### Step 4: 실제 데이터 수집 시작 🚀

```
3_데이터수집_시작.bat 더블클릭
```

**중요**:
- ✅ 창을 닫지 마세요 (최소화는 가능)
- ✅ 매일 백엔드 켤 때마다 실행
- ✅ 14일 또는 100개 토론 달성 시 자동 종료

**실행 화면**:
```
================================================================================
🚀 데이터 수집 시작
================================================================================

실행 모드: 연속 수집 (14일, 100개 토론 목표)
뉴스 체크 간격: 5분

⚠️  중요 안내:
   1. 이 창을 닫지 마세요 (최소화는 가능합니다)
   2. 매일 백엔드 켤 때마다 실행하세요
   3. 중단하려면 Ctrl+C를 누르세요
   4. 목표 달성 시 자동으로 종료됩니다

[CYCLE #1] - 2025-12-27 10:00:00
...
```

---

## 📊 모니터링 및 관리

### 실시간 모니터링 (선택)

```
4_모니터링_대시보드.bat 더블클릭 (별도 창)
```

**대시보드 내용**:
- 수집된 뉴스 기사 수
- 완료된 토론 수
- Constitutional 통과율
- 최근 검증 기록

---

### 품질 리포트 생성 (주기적)

```
5_품질리포트_생성.bat 더블클릭
```

**리포트 내용**:
- 📰 뉴스 품질 (0-100점)
- 🎭 토론 품질 (평균 신뢰도)
- 🏛️ Constitutional 준수율
- 📊 시그널 다양성
- **전체 품질 점수 (0-100점)**

---

### 로그 확인 (문제 발생 시)

```
6_로그_확인.bat 더블클릭
```

**확인 내용**:
- logs 디렉토리 파일 목록
- data_accumulation.log 최근 30줄
- constitutional_validations.jsonl 최근 10개

---

## 🔧 개선된 기능

### 1. 자동 환경 감지
- ✅ 로컬 PostgreSQL 자동 시도
- ✅ 실패 시 Docker PostgreSQL 자동 전환
- ✅ 파일 경로 자동 검증

### 2. 에러 처리 강화
- ✅ 파일 미존재 시 명확한 에러 메시지
- ✅ Python/PostgreSQL 미설치 시 해결 방법 안내
- ✅ 실행 실패 시 문제 해결 가이드

### 3. 사용자 친화적
- ✅ 진행 단계 표시 ([1/4], [2/4], ...)
- ✅ 성공/실패 명확한 시각적 표시
- ✅ 다음 단계 안내

---

## 💡 일일 사용 패턴

### 백엔드 시작할 때

```
1. 0_시스템_체크.bat (최초 1회만)
2. 1_DB_마이그레이션.bat (최초 1회만)
3. 3_데이터수집_시작.bat ⭐ (매일)
4. 4_모니터링_대시보드.bat (선택, 별도 창)
```

### 주간 체크 (주 1회)

```
1. 5_품질리포트_생성.bat
2. 품질 점수 확인
   - 80점 이상: ✅ 정상
   - 60-79점: ⚠️ 주의
   - 60점 미만: ❌ 개선 필요
```

---

## ⚠️ 주의사항

### ✅ 해야 할 것
- ✅ 최초 1회: `0_시스템_체크.bat` → `1_DB_마이그레이션.bat`
- ✅ 매일: `3_데이터수집_시작.bat` 실행 후 창 최소화
- ✅ 주기적: `5_품질리포트_생성.bat`으로 품질 확인

### ❌ 하지 말아야 할 것
- ❌ `3_데이터수집_시작.bat` 창 닫기
- ❌ PostgreSQL/Docker 중단
- ❌ logs 폴더 삭제

---

## 🔧 문제 해결

### "Python을 찾을 수 없습니다"

**해결**:
```
1. Python 설치 확인
2. 환경변수 PATH 확인
3. 또는: python 대신 C:\Python311\python.exe 사용
```

---

### "PostgreSQL 연결 실패"

**해결**:
```bash
# Docker 사용 시
docker ps  # 컨테이너 확인
docker start ai-trading-postgres  # 시작

# 로컬 PostgreSQL 사용 시
net start postgresql-x64-15  # Windows 서비스 시작
```

---

### "마이그레이션 실패"

**해결**:
```
1. PostgreSQL이 실행 중인지 확인
2. 데이터베이스 'ai_trading_system' 존재 확인
3. 비밀번호 확인
```

---

## 📊 성공 기준

14일 후 이런 결과가 나오면 성공:

| 지표 | 목표 |
|------|------|
| ✅ 총 토론 수 | 100개+ |
| ✅ 고유 티커 | 10개+ |
| ✅ Constitutional 통과율 | 90%+ |
| ✅ 평균 신뢰도 | 75%+ |
| ✅ 전체 품질 점수 | 80점+ |

---

## 📁 생성되는 파일

```
D:\code\ai-trading-system\
├── logs\
│   ├── data_accumulation.log               ← 메인 로그
│   ├── constitutional_validations.jsonl    ← 검증 백업
│   ├── accumulation_stats_*.json           ← 세션 통계
│   └── quality_report_*.json               ← 품질 리포트
```

---

## 🎉 빠른 시작 요약

```
처음:
  0_시스템_체크.bat → 1_DB_마이그레이션.bat → 2_데이터수집_테스트.bat

매일:
  3_데이터수집_시작.bat (창 최소화)

주간:
  5_품질리포트_생성.bat

문제 시:
  6_로그_확인.bat
```

---

**작성일**: 2025-12-27
**버전**: 2.0 (개선판)
**상태**: ✅ 테스트 완료
