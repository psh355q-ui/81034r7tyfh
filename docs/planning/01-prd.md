# PRD (제품 요구사항 정의서)
# GLM-4.7 뉴스 해석 서비스

> 이 문서는 비기술자의 언어로 쉽고 비유적으로 작성합니다.

---

## MVP 캡슐

| # | 항목 | 내용 |
|---|------|------|
| 1 | 목표 | AI 트레이딩 시스템의 뉴스 해석 비용을 절감하고 분석 품질을 향상시키는 것 |
| 2 | 페르소나 | AI 트레이딩 시스템 개발자 (기존 시스템에 newspoller 존재, 로컬 LLM 사용 중) |
| 3 | 핵심 기능 | FEAT-1: 종목/섹터 식별 (뉴스에서 관련 종목과 섹터를 추출) |
| 4 | 성공 지표 (노스스타) | GLM API가 뉴스 분석 성공률 95% 이상, 평균 응답 시간 2초 이내 |
| 5 | 입력 지표 | GLM API 호출 성공률, 평균 응답 시간 |
| 6 | 비기능 요구 | 기존 Claude/Gemini/ChatGPT 클라이언트와 동일한 인터페이스로 통합 |
| 7 | Out-of-scope | 트레이딩 시그널 직접 생성, 포지션 사이즈 결정, 손절/익절 판단 |
| 8 | Top 리스크 | GLM API 장애 시 뉴스 분석 파이프라인 중단 |
| 9 | 완화/실험 | 기존 로컬 LLM을 Fallback으로 유지하여 A/B 테스트 |
| 10 | 다음 단계 | newspoller에 GLM 클라이언트 연동하여 실시간 뉴스 분석 테스트 |

---

## 1. 문제 정의

### 1.1 현재 상황 (As-Is)
AI 트레이딩 시스템 개발자가 newspoller로 실시간 뉴스를 수집하고 있는데, 현재 로컬 LLM으로 분석하고 있습니다. 로컬 LLM은 무료지만 분석 품질이 일정하지 않고, GPT-4 같은 고성능 모델을 쓰자니 비용이 너무 비쌉니다. 마치 "비싼 식당은 맛있지만 돈이 없고, 싼 식당은 맛이 없는" 딜레마 상황입니다.

### 1.2 목표 상황 (To-Be)
GLM-4.7 API를 활용하여 "적절한 가격에 준수한 품질의 뉴스 분석"을 제공하는 것입니다. 뉴스가 수집되면 자동으로 GLM-4.7이 분석하고, 종목/섹터를 식별하여 구조화된 데이터로 저장합니다. 기존 시스템과 완벽하게 호환되어 마치 "원래부터 있던 모듈처럼" 작동합니다.

### 1.3 왜 지금인가? (Why Now)
GLM-4.7은 GPT-4급 추론력에 합리적인 가격을 제공하고, 특히 금융 텍스트 해석에 강점이 있습니다. 현재 시스템에 newspoller가 이미 구축되어 있어 GLM 연동만 하면 바로 사용 가능한 상태입니다.

---

## 2. 사용자 페르소나

### 2.1 주요 페르소나

| 항목 | 내용 |
|------|------|
| 이름/별칭 | "AI 트레이딩 개발자" |
| 나이/직업 | 30대 풀스택 개발자, 퀀트 트레이딩에 관심 |
| 핵심 니즈 | 뉴스를 구조화된 데이터로 변환하여 트레이딩 시그널 생성에 활용 |
| 불편 포인트 | API 비용 부담, 로컬 LLM 품질 불안정, 구조화된 출력 부족 |
| 사용 상황 | 실시간 뉴스 수집 시, 일일 리포트 생성 시, DB 자동 저장 시 |

### 2.2 페르소나의 하루 (시나리오)
오전 9시, 시장이 열리면 newspoller가 50개 이상의 뉴스를 수집합니다. 개발자는 각 뉴스가 어떤 종목에 영향을 주는지 빠르게 파악하고 싶습니다. 현재 로컬 LLM은 분석 결과가 불안정해서, GLM-4.7을 통해 더 정확한 종목/섹터 식별을 원합니다. 분석 결과는 자동으로 DB에 저장되어 War Room에서 트레이딩 결정에 활용됩니다.

---

## 3. 사용자 스토리

### FEAT-1: 종목/섹터 식별 (MVP)
- [ ] 개발자로서, 뉴스 텍스트를 GLM-4.7 API에 전송하여 종목/섹터 식별 결과를 JSON으로 받을 수 있어야 한다. 왜냐하면 구조화된 데이터로 저장하고 활용하기 위해서다.
- [ ] 개발자로서, GLM-4.7 분석 결과를 기존 news_articles 테이블에 JSON 컬럼으로 저장할 수 있어야 한다. 왜냐하면 Repository Pattern을 유지하고 기존 코드와 호환되기 위해서다.
- [ ] 개발자로서, GLM API 호출 실패 시 기존 로컬 LLM으로 Fallback되어야 한다. 왜냐하면 뉴스 분석 파이프라인 중단을 방지하기 위해서다.

### FEAT-2: 이벤트 태깅 & 중요도 스코어링 (v2)
- [ ] 개발자로서, 뉴스를 이벤트 타입(공급망, 규제, 실적 등)으로 분류받을 수 있어야 한다. 왜냐하면 이벤트별로 다른 트레이딩 전략을 적용하기 위해서다.
- [ ] 개발자로서, 뉴스의 중요도를 0-100 점수로 평가받을 수 있어야 한다. 왜냐하면 중요한 뉴스부터 우선 처리하기 위해서다.

### FEAT-3: 감성 분석 & 요약 (v2)
- [ ] 개발자로서, 뉴스의 긍정/부정 감성을 분석받을 수 있어야 한다. 왜냐하면 시장 심리를 파악하기 위해서다.
- [ ] 개발자로서, 뉴스를 2-3문장으로 요약받을 수 있어야 한다. 왜냐하면 많은 뉴스를 빠르게 스캔하기 위해서다.

---

## 4. 성공 지표

### 4.1 노스스타 지표 (결과 지표)
| 지표명 | 정의 | 목표치 | 측정 주기 |
|--------|------|--------|----------|
| GLM API 성공률 | GLM API 호출 중 성공적으로 응답을 받은 비율 | 95% 이상 | 일간 |
| 평균 응답 시간 | GLM API 호출부터 응답 수신까지의 평균 시간 | 2초 이내 | 일간 |

### 4.2 입력 지표 (행동 지표)
| 지표명 | 정의 | 목표치 |
|--------|------|--------|
| GLM API 호출 성공률 | GLM API 호출 중 HTTP 200 응답을 받은 비율 | 98% 이상 |
| DB 저장 성공률 | GLM 분석 결과가 DB에 성공적으로 저장된 비율 | 99% 이상 |

---

## 5. 범위 관리

### 5.1 MVP (반드시 포함)
- FEAT-1: 종목/섹터 식별
- GLM-4.7 API 연동
- 기존 news_articles 테이블에 JSON 컬럼으로 저장
- newspoller 연동

### 5.2 옵션 (시간 허용 시)
- 이벤트 태깅 & 중요도 스코어링
- 감성 분석 & 요약
- 임베딩 생성

### 5.3 Non-goals (명시적 제외)
- 트레이딩 시그널 직접 생성 (이것은 War Room의 역할)
- 포지션 사이즈 결정 (이것은 Order Executor의 역할)
- 손절/익절 판단 (이것은 Risk Manager의 역할)
- 별도의 프론트엔드 UI (기존 시스템 활용)

---

## 6. 가정과 리스크

### 6.1 핵심 가정
| # | 가정 | 검증 방법 |
|---|------|----------|
| 1 | GLM-4.7이 금융 뉴스 분석에서 GPT-4 대비 충분한 품질을 제공한다 | 실제 뉴스 데이터로 A/B 테스트 |

### 6.2 Top 5 리스크 보드

| # | 가정 | 리스크 | 완화 | 트리거 | 대응 |
|---|------|--------|------|--------|------|
| 1 | GLM API 안정성 | API 장애 시 뉴스 분석 중단 | 로컬 LLM Fallback 유지 | API 실패률 5% 초과 | 자동 Fallback |
| 2 | 분석 품질 | GLM이 기존보다 낮은 품질 생성 | 과거 데이터 백테스트 | 정확도 90% 미만 | GPT-4로 일부 재분석 |
| 3 | 비용 증가 | 예상보다 API 호출 비용 증가 | 캐싱 전략 도입 | 월 비용 20% 초과 | 배치 처리 최적화 |
| 4 | 통합 복잡도 | 기존 시스템과의 호환성 이슈 | 기존 클라이언트 패턴 따르기 | CI 통과 실패 | 통합 테스트 강화 |
| 5 | 응답 시간 | 실시간 처리에 응답이 늦음 | 비동기 처리 도입 | 평균 3초 초과 | 배치 큐 도입 |

---

## 7. 해결 가설과 실험

### 7.1 가설
> 만약 GLM-4.7 API를 뉴스 해석에 사용하면, 로컬 LLM 대비 향상된 분석 품질과 GPT-4 대비 50% 이상의 비용 절감 효과가 나올 것이다. 왜냐하면 GLM-4.7은 금융 텍스트 해석에 특화되어 있고 합리적인 가격을 제공하기 때문이다.

### 7.2 실험 루프

```
실험 → 관측 → 학습 → 다음 가설
```

| 단계 | 내용 |
|------|------|
| 실험 | newspoller에 GLM 클라이언트 연동, 실시간 뉴스 100건 분석 |
| 관측 | API 성공률, 응답 시간, 분석 품질(종목 식별 정확도), 비용 측정 |
| 학습 | 성공률 95% 이상, 응답 시간 2초 이내 달성 시 성공 |
| 다음 | MVP 성공 시 이벤트 태깅, 감성 분석 등 고급 기능 확장 |

---

## Decision Log 참조

| ID | 항목 | 선택 | 근거 | 영향 | 보류안 |
|----|------|------|------|------|--------|
| D-01 | 프로젝트명 | GLM-4.7 뉴스 해석 서비스 | AI 트레이딩용 뉴스 분석 엔진으로 명확한 정의 | 문서/코드 명명 규칙 | - |
| D-02 | 목적 | AI 트레이딩용 뉴스 분석 엔진 | 시스템 내에서의 역할 명확화 | 아키텍처 설계 | - |
| D-03 | 동기 | GLM-4.7 활용 | 가성비와 금융 텍스트 강점 활용 | 기술 스택 선택 | - |
| D-04 | 해결 문제 | 높은 API 비용 | 비용 절감이 주요 목표 | 비용 모니터링 지표 | - |
| D-05 | 페르소나 | AI 트레이딩 시스템 개발자 | 기존 시스템 통합이 핵심 | API 설계, 문서 톤 | - |
| D-06 | 사용 상황 | 실시간 뉴스 처리, DB 저장, 리포트 | newspoller 연동 필요 | 비동기 처리 설계 | - |
| D-07 | 핵심 기능 | 이벤트 태깅, 종목 식별, 감성 분석, 요약, 구조화 출력 | 종목/섹터 식별이 MVP | MVP 범위 고정 | - |
| D-08 | MVP 핵심 | 종목/섹터 식별 | 가장 기본적이고 필수적인 기능 | 개발 우선순위 | - |
| D-09 | 불만 사례 | 구조화된 출력 부족 | JSON 형태로 구조화된 데이터 필요 | 출력 포맷 설계 | - |
| D-10 | UX/UI | 기존 시스템과 호환 | Claude/Gemini/ChatGPT 클라이언트와 동일 패턴 | 코드 구조 설계 | - |
| D-11 | 사용 환경 | newspoller와 연동 | 기존 컴포넌트와 통합 | 통합 전략 | - |
| D-12 | 외부 연동 | GLM-4.7 API만 | 단일 책임 원칙 | API 설계 | - |
| D-13 | 데이터 저장 | 기존 테이블에 JSON 컬럼 추가 | Repository Pattern 유지 | DB 스키마 설계 | 전용 테이블 생성 |
| D-14 | 가치 제안 | 분석 품질 향상 | GLM-4.7의 금융 강점 활용 | 품질 평가 기준 | - |
| D-15 | 로깅 스타일 | 기존 스타일 유지 (구조화된 로그) | 기존 모니터링과 호환 | 로깅 포맷 | - |
| D-16 | 성공 기준 | API 성공률 95%, 응답 시간 2초 | 실용적인 운영 목표 | 모니터링 지표 | - |
| D-17 | 수익화 | 비용 절감 (내부 효용) | 직접 수익화 없음 | 비즈니스 모델 | - |
| D-18 | 검증 방식 | 실시간 뉴스 분석 테스트 | 실제 환경 검증 | 테스트 전략 | - |
| D-19 | 백엔드 | FastAPI (기존 시스템과 동일) | 기존 패턴 유지 | 아키텍처 | - |
| D-20 | AI 클라이언트 | 단일 GLM 클라이언트 클래스 | 코드 일관성, 유지보수 용이 | 클래스 설계 | 다중 클래스 구조 |
| D-21 | DB 저장 | NewsRepository 확장 | Repository Pattern 유지 | 코드 구조 | 전용 Repository 생성 |
